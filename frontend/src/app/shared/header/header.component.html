<header class="header">
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-left">
      <span>ðŸšš Free Shipping on Orders Over $50</span>
    </div>
    <div class="top-right">
      <a href="#">Help</a>
      <a href="#">Contact</a>
      <select>
        <option>EN</option>
        <option>FR</option>
      </select>
    </div>
  </div>

  <!-- Main Navbar -->
  <div class="navbar">
    <div class="nav-left">
      <a routerLink="/" class="logo">
        Shop<span>Fast</span>
      </a>
    </div>

    <div class="nav-center">
      <div class="search-bar">
        <input
          type="text"
          (keyup)="doSearch()"
          [(ngModel)]="query"
          placeholder="Search for products, categories, brands..."
        />
        <button (click)="doSearch()"><i class="fa fa-search"></i></button>
      </div>
    </div>

    <div class="nav-right">
      <a routerLink="/product" class="nav-link">Products</a>
      <a routerLink="/profile" class="nav-link">Profile</a>

      <!-- ðŸŒŸ Notification Bell -->
      <div class="notif-wrapper">
        <i class="fa fa-bell notif-icon" (click)="toggleDropdown()"></i>

        <!-- Unread Count -->
        <span class="notif-badge" *ngIf="unreadCount > 0">{{ unreadCount }}</span>

        <!-- Dropdown Menu -->
        <div class="notif-dropdown" *ngIf="isDropdownOpen" (click)="$event.stopPropagation()">

          <div class="notif-header">
            <h4>Notifications</h4>
            <span class="view-all">View All</span>
          </div>
          <div class="notif-list" (scroll)="onScroll($event)">
            <div
              class="notif-item"
              *ngFor="let n of notifications"
              [class.unread]="n.readAt === null"
              (click)="markAsRead(n)"
            >
              <div class="notif-icon-box">
                <i class="fa"
                   [ngClass]="{
               'fa-shopping-bag': n.type === 'ORDER_CREATED',
               'fa-check-circle': n.type === 'ORDER_DELIVERED',
               'fa-truck': n.type === 'ORDER_SHIPPED',
               'fa-ban': n.type === 'ORDER_CANCELLED',
               'fa-bolt': n.type === 'PROMOTION',
               'fa-envelope': true
             }">
                </i>
              </div>

              <div class="notif-content">
                <div class="notif-title">{{ n.subject }}</div>
                <div class="notif-desc">{{ n.content }}</div>
                <div class="notif-time">{{ n.createdAt | date:'short' }}</div>
              </div>
            </div>
          </div>

          <div class="notif-loading" *ngIf="loading">Loading more...</div>
          <div class="notif-end" *ngIf="lastPage && notifications.length > 0">
            No more notifications
          </div>
        </div>
      </div>

      <!-- Cart -->
      <a routerLink="/cart" class="icon-btn cart">
        <i class="fa fa-shopping-cart"></i>
        <span class="cart-count">{{ (cartCount$ | async) || 0 }}</span>
      </a>

      <!-- Auth -->
      <ng-container *ngIf="(user$ | async) as u; else guest">
        <span class="user">Hi, {{ u.email }}</span>
        <button (click)="logout()" class="btn-logout">Logout</button>
      </ng-container>

      <ng-template #guest>
        <a routerLink="/login" class="nav-link">Login</a>
        <a routerLink="/signup" class="btn-primary small">Sign Up</a>
      </ng-template>
    </div>

    <!-- Mobile menu toggle -->
    <button class="menu-toggle" (click)="toggleMenu()">
      <i class="fa fa-bars"></i>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div class="mobile-menu" [class.open]="menuOpen">
    <a routerLink="/product" (click)="closeMenu()">Products</a>
    <a routerLink="/profile" (click)="closeMenu()">Profile</a>
    <a routerLink="/cart" (click)="closeMenu()">Cart ({{ (cartCount$ | async) || 0 }})</a>
    <a routerLink="/login" (click)="closeMenu()" *ngIf="!(user$ | async)">Login</a>
    <a routerLink="/signup" (click)="closeMenu()" *ngIf="!(user$ | async)">Sign Up</a>
  </div>
</header>
